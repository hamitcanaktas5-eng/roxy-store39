<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Dashboard - Roxy Store</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700;800;900&display=swap');
*,*::before,*::after{margin:0;padding:0;box-sizing:border-box;}
:root{--p:#00D9FF;--s:#A855F7;--g:#00FF88;--dark:#0A0A0F;--d2:#12121A;--d3:#1A1A28;--border:rgba(0,217,255,.12);--muted:#A0A0B8;--err:#FF6584;--warn:#FFB347;}
body{font-family:'Poppins',sans-serif;background:var(--dark);color:#fff;overflow-x:hidden;}
/* SIDEBAR */
.sidebar{position:fixed;left:-280px;top:0;width:270px;height:100vh;background:rgba(26,26,40,.98);backdrop-filter:blur(24px);border-right:1px solid var(--border);z-index:1000;transition:left .3s ease;display:flex;flex-direction:column;box-shadow:4px 0 40px rgba(0,0,0,.4);}
.sidebar.open{left:0;}
.sb-head{padding:22px 20px;border-bottom:1px solid rgba(255,255,255,.05);display:flex;align-items:center;justify-content:space-between;flex-shrink:0;}
.logo{display:flex;align-items:center;gap:12px;}
.logo-icon{width:42px;height:42px;background:linear-gradient(135deg,var(--p),var(--s));border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:18px;color:#0A0A0F;box-shadow:0 0 20px rgba(0,217,255,.3);}
.logo-main{font-size:22px;font-weight:900;background:linear-gradient(135deg,var(--p),var(--s));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;}
.logo-sub{font-size:10px;font-weight:600;color:var(--muted);letter-spacing:2px;display:block;}
.sb-close{background:transparent;border:none;color:var(--muted);font-size:22px;cursor:pointer;padding:6px;border-radius:8px;transition:.2s;}
.sb-close:hover{color:var(--p);background:rgba(0,217,255,.08);}
.sb-nav{flex:1;overflow-y:auto;padding:12px 0;}
.sb-nav::-webkit-scrollbar{width:3px;}
.sb-nav::-webkit-scrollbar-thumb{background:var(--border);border-radius:3px;}
.nav-item{display:flex;align-items:center;gap:12px;padding:13px 20px;color:var(--muted);text-decoration:none;border-left:3px solid transparent;font-size:14px;font-weight:500;transition:all .2s;cursor:pointer;}
.nav-item:hover{background:rgba(0,217,255,.06);color:var(--p);border-left-color:var(--p);}
.nav-item.active{background:rgba(0,217,255,.08);color:var(--p);border-left-color:var(--p);}
.nav-item i{width:20px;font-size:17px;text-align:center;}
.nav-sep{height:1px;background:rgba(255,255,255,.06);margin:8px 16px;}
.nav-item.support{color:var(--p);font-weight:700;}
.overlay{position:fixed;inset:0;background:rgba(0,0,0,.6);z-index:999;opacity:0;visibility:hidden;transition:.3s;}
.overlay.active{opacity:1;visibility:visible;}
/* MAIN */
.main{min-height:100vh;display:flex;flex-direction:column;}
/* TOPBAR */
.topbar{background:rgba(26,26,40,.98);backdrop-filter:blur(24px);border-bottom:1px solid var(--border);padding:0 24px;height:68px;display:flex;align-items:center;justify-content:space-between;position:sticky;top:0;z-index:100;}
.tb-left{display:flex;align-items:center;gap:14px;}
.menu-btn{background:transparent;border:none;color:#fff;font-size:22px;cursor:pointer;padding:8px;border-radius:8px;transition:.2s;}
.menu-btn:hover{color:var(--p);background:rgba(0,217,255,.08);}
.tb-logo-text{font-size:18px;font-weight:900;background:linear-gradient(135deg,var(--p),var(--s));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;}
.tb-logo-sub{font-size:10px;color:var(--muted);letter-spacing:1.5px;font-weight:600;}
.tb-right{display:flex;align-items:center;gap:14px;}
.bal-box{display:flex;align-items:center;gap:10px;padding:9px 14px;background:rgba(0,217,255,.07);border:1.5px solid rgba(0,217,255,.2);border-radius:12px;cursor:pointer;transition:.2s;}
.bal-box:hover{border-color:var(--p);background:rgba(0,217,255,.12);}
.bal-box i{color:var(--p);font-size:18px;}
.bal-label{font-size:10px;color:var(--muted);display:block;text-transform:uppercase;letter-spacing:.5px;}
.bal-amount{font-size:15px;font-weight:800;color:var(--p);}
.user-box{display:flex;align-items:center;gap:8px;cursor:pointer;padding:6px 10px;border-radius:10px;transition:.2s;}
.user-box:hover{background:rgba(255,255,255,.05);}
.user-box img{width:38px;height:38px;border-radius:50%;border:2px solid var(--p);}
.user-box span{font-weight:600;font-size:14px;}
/* CONTENT */
.content{flex:1;padding:32px 24px 60px;max-width:1200px;width:100%;margin:0 auto;}
.welcome{margin-bottom:28px;}
.welcome h1{font-size:30px;font-weight:900;margin-bottom:6px;}
.welcome p{color:var(--muted);}
/* STATS */
.stats{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:16px;margin-bottom:28px;}
.stat{background:var(--d3);border:1.5px solid var(--border);border-radius:18px;padding:24px;transition:.2s;}
.stat:hover{border-color:rgba(0,217,255,.25);transform:translateY(-2px);}
.stat.main-stat{background:linear-gradient(135deg,rgba(0,217,255,.1),rgba(168,85,247,.1));border-color:rgba(0,217,255,.22);}
.stat-icon{width:50px;height:50px;border-radius:14px;display:flex;align-items:center;justify-content:center;font-size:22px;margin-bottom:14px;}
.i-blue{background:rgba(0,217,255,.1);color:var(--p);}
.i-red{background:rgba(255,101,132,.1);color:var(--err);}
.i-warn{background:rgba(255,179,71,.1);color:var(--warn);}
.i-green{background:rgba(0,255,136,.1);color:var(--g);}
.stat-label{font-size:13px;color:var(--muted);display:block;margin-bottom:6px;}
.stat-val{font-size:28px;font-weight:900;}
.btn-load{display:flex;align-items:center;justify-content:center;gap:8px;width:100%;padding:11px;background:linear-gradient(135deg,var(--p),var(--s));border:none;border-radius:10px;color:#0A0A0F;font-family:'Poppins',sans-serif;font-weight:700;font-size:14px;cursor:pointer;margin-top:14px;transition:.2s;}
.btn-load:hover{opacity:.9;transform:translateY(-1px);}
/* QUICK */
.sec-title{font-size:20px;font-weight:800;margin-bottom:16px;}
.quick{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:14px;margin-bottom:28px;}
.qbtn{display:flex;flex-direction:column;align-items:center;gap:10px;padding:22px;background:var(--d3);border:1.5px solid var(--border);border-radius:16px;color:#fff;cursor:pointer;font-family:'Poppins',sans-serif;transition:.2s;}
.qbtn:hover{border-color:var(--p);background:rgba(0,217,255,.05);transform:translateY(-3px);}
.qbtn i{font-size:28px;color:var(--p);}
.qbtn span{font-weight:600;font-size:14px;}
/* ORDERS */
.orders-box{background:var(--d3);border:1.5px solid var(--border);border-radius:18px;overflow:hidden;}
.order-row{display:flex;align-items:center;justify-content:space-between;padding:15px 18px;border-bottom:1px solid rgba(255,255,255,.04);}
.order-row:last-child{border-bottom:none;}
.ord-id{font-size:13px;font-weight:700;color:var(--p);}
.ord-info{font-size:12px;color:var(--muted);margin-top:3px;}
.ord-price{font-weight:800;font-size:14px;}
.ord-status{font-size:12px;margin-top:3px;}
.empty{text-align:center;padding:50px 20px;color:var(--muted);}
.empty i{font-size:48px;opacity:.25;display:block;margin-bottom:14px;}
/* FOOTER */
footer{background:var(--d3);border-top:1px solid var(--border);padding:22px 24px;margin-top:auto;}
.foot-in{max-width:1200px;margin:0 auto;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:14px;}
.foot-links{display:flex;gap:10px;}
.foot-link{display:flex;align-items:center;gap:6px;padding:8px 14px;border-radius:8px;text-decoration:none;font-size:13px;font-weight:600;color:#fff;transition:.2s;}
.foot-link:hover{opacity:.85;transform:translateY(-1px);}
.wa{background:#25D366;}.tg{background:#0088CC;}
.foot-copy{color:var(--muted);font-size:13px;}
@media(max-width:768px){.user-box span,.bal-label{display:none;}.content{padding:20px 14px 50px;}.welcome h1{font-size:22px;}.stats{grid-template-columns:1fr 1fr;}}
@media(max-width:480px){.stats{grid-template-columns:1fr;}.tb-logo-sub{display:none;}}
@keyframes _roxyFadeIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
</style>
</head>
<body>

<!-- SIDEBAR -->
<div class="sidebar" id="sidebar">
  <div class="sb-head">
    <div class="logo">
      <div class="logo-icon"><i class="fas fa-bolt"></i></div>
      <div><span class="logo-main">ROXY</span><span class="logo-sub">STORE</span></div>
    </div>
    <button class="sb-close" onclick="toggleSidebar()"><i class="fas fa-times"></i></button>
  </div>
  <nav class="sb-nav">
    <a href="dashboard.html" class="nav-item active"><i class="fas fa-home"></i><span>Ana Sayfa</span></a>
    <a href="virtual-number.html" class="nav-item"><i class="fas fa-mobile-alt"></i><span>Sanal Numara</span></a>
    <a href="social-media.html" class="nav-item"><i class="fas fa-chart-line"></i><span>Sosyal Medya</span></a>
    <a href="balance.html" class="nav-item"><i class="fas fa-wallet"></i><span>Bakiye Ekle</span></a>
    <a href="reviews.html" class="nav-item"><i class="fas fa-star"></i><span>Deƒüerlendirmeler</span></a>
    <div class="nav-sep"></div>
    <a href="support.html" class="nav-item support"><i class="fas fa-headset"></i><span>Destek</span></a>
    <a href="profile.html" class="nav-item"><i class="fas fa-user-circle"></i><span>Profil</span></a>
    <div class="nav-item" onclick="handleLogout()" style="margin-top:8px"><i class="fas fa-sign-out-alt"></i><span>√áƒ±kƒ±≈ü Yap</span></div>
  </nav>
</div>
<div class="overlay" id="overlay" onclick="toggleSidebar()"></div>

<!-- MAIN -->
<div class="main">
  <div class="topbar">
    <div class="tb-left">
      <button class="menu-btn" onclick="toggleSidebar()"><i class="fas fa-bars"></i></button>
      <div><span class="tb-logo-text">ROXY</span> <span class="tb-logo-sub">STORE</span></div>
    </div>
    <div class="tb-right">
      <div class="bal-box" onclick="window.location.href='balance.html'" title="Bakiye Ekle">
        <i class="fas fa-wallet"></i>
        <div><span class="bal-label">Bakiye</span><span class="bal-amount" id="balDisplay">0 ‚Ç∫</span></div>
      </div>
      <div class="user-box" onclick="window.location.href='profile.html'">
        <img id="userAvatar" src="https://ui-avatars.com/api/?name=U&background=00D9FF&color=fff" alt="">
        <span id="userName">Kullanƒ±cƒ±</span>
      </div>
    </div>
  </div>

  <div class="content">
    <div class="welcome">
      <h1 id="welcomeMsg">Ho≈ü Geldiniz! üëã</h1>
      <p>Hesabƒ±nƒ±zƒ± y√∂netin ve hizmetlerimizden yararlanƒ±n</p>
    </div>

    <div class="stats">
      <div class="stat main-stat">
        <div class="stat-icon i-blue"><i class="fas fa-wallet"></i></div>
        <span class="stat-label">Mevcut Bakiye</span>
        <div class="stat-val" id="statBal">0 ‚Ç∫</div>
        <button class="btn-load" onclick="window.location.href='balance.html'"><i class="fas fa-plus"></i> Bakiye Y√ºkle</button>
      </div>
      <div class="stat">
        <div class="stat-icon i-red"><i class="fas fa-box"></i></div>
        <span class="stat-label">Toplam Sipari≈ü</span>
        <div class="stat-val" id="statTotal">‚Äî</div>
      </div>
      <div class="stat">
        <div class="stat-icon i-warn"><i class="fas fa-clock"></i></div>
        <span class="stat-label">Bekleyen</span>
        <div class="stat-val" id="statPend">‚Äî</div>
      </div>
      <div class="stat">
        <div class="stat-icon i-green"><i class="fas fa-check-circle"></i></div>
        <span class="stat-label">Tamamlanan</span>
        <div class="stat-val" id="statDone">‚Äî</div>
      </div>
    </div>

    <div class="sec-title">Hƒ±zlƒ± ƒ∞≈ülemler</div>
    <div class="quick">
      <button class="qbtn" onclick="window.location.href='virtual-number.html'"><i class="fas fa-mobile-alt"></i><span>Sanal Numara Al</span></button>
      <button class="qbtn" onclick="window.location.href='social-media.html'"><i class="fas fa-chart-line"></i><span>SMM Sipari≈ü Ver</span></button>
      <button class="qbtn" onclick="window.location.href='balance.html'"><i class="fas fa-wallet"></i><span>Bakiye Y√ºkle</span></button>
      <button class="qbtn" onclick="window.location.href='support.html'"><i class="fas fa-headset"></i><span>Destek Al</span></button>
    </div>

    <div class="sec-title">Son Sipari≈üler</div>
    <div class="orders-box" id="ordersBox">
      <div class="empty"><i class="fas fa-box-open"></i><p>Hen√ºz sipari≈ü yok</p></div>
    </div>
  </div>

  <footer>
    <div class="foot-in">
      <div class="foot-links">
        <a href="https://wa.me/447795203704" target="_blank" class="foot-link wa"><i class="fab fa-whatsapp"></i> WhatsApp</a>
        <a href="https://t.me/roxysatici" target="_blank" class="foot-link tg"><i class="fab fa-telegram"></i> Telegram</a>
      </div>
      <span class="foot-copy">¬© 2026 Roxy Store. T√ºm haklarƒ± saklƒ±dƒ±r.</span>
    </div>
  </footer>
</div>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<script>
// FIREBASE INIT
var _app=firebase.apps.length?firebase.apps[0]:firebase.initializeApp({apiKey:"AIzaSyBf2A1GhEzruI_6lfCNbq4MsbU8hxFjoqI",authDomain:"roxy-store-67c53.firebaseapp.com",projectId:"roxy-store-67c53",storageBucket:"roxy-store-67c53.firebasestorage.app",messagingSenderId:"450502544206",appId:"1:450502544206:web:502d0200dc35ecacfc2c1f"});
var auth=firebase.auth(), db=firebase.firestore();

function formatPrice(n){return Math.round(n||0).toLocaleString('tr-TR')+' ‚Ç∫';}
function toggleSidebar(){document.getElementById('sidebar').classList.toggle('open');document.getElementById('overlay').classList.toggle('active');}

// ROXYUI
var RoxyUI={
  toast:function(msg,type,dur){
    dur=dur||3500;
    var c={success:'#00FF88',error:'#FF6584',warning:'#FFB347',info:'#00D9FF'};
    var ic={success:'check-circle',error:'times-circle',warning:'exclamation-triangle',info:'info-circle'};
    var w=document.getElementById('_rt');
    if(!w){w=document.createElement('div');w.id='_rt';w.style.cssText='position:fixed;bottom:24px;right:24px;z-index:99999;display:flex;flex-direction:column;gap:10px;max-width:360px;';document.body.appendChild(w);}
    var t=document.createElement('div');
    t.style.cssText='display:flex;align-items:center;gap:12px;padding:14px 18px;background:#1F1F2E;border:1.5px solid '+(c[type]||c.info)+';border-radius:14px;font-family:Poppins,sans-serif;font-size:14px;color:#fff;box-shadow:0 8px 32px rgba(0,0,0,.5);';
    t.innerHTML='<i class="fas fa-'+(ic[type]||'info-circle')+'" style="color:'+(c[type]||c.info)+';font-size:18px;flex-shrink:0"></i><span>'+msg+'</span>';
    w.appendChild(t);
    setTimeout(function(){t.style.transition='.3s';t.style.opacity='0';t.style.transform='translateY(8px)';setTimeout(function(){t.remove();},300);},dur);
  },
  confirm:function(title,msg,ok,cancel,danger){
    return new Promise(function(resolve){
      var ov=document.createElement('div');
      ov.style.cssText='position:fixed;inset:0;background:rgba(0,0,0,.75);z-index:99998;display:flex;align-items:center;justify-content:center;padding:16px;';
      ov.innerHTML='<div style="background:#1A1A28;border:1.5px solid rgba(0,217,255,.2);border-radius:20px;padding:36px 30px;max-width:420px;width:100%;text-align:center;font-family:Poppins,sans-serif;">'
        +'<i class="fas fa-question-circle" style="font-size:48px;color:#00D9FF;margin-bottom:14px;display:block;"></i>'
        +'<div style="font-size:19px;font-weight:800;margin-bottom:10px;">'+title+'</div>'
        +'<div style="font-size:14px;color:#A0A0B8;line-height:1.7;margin-bottom:26px;">'+msg+'</div>'
        +'<div style="display:flex;gap:12px;justify-content:center;">'
        +'<button id="_rC" style="padding:12px 24px;background:transparent;border:1.5px solid rgba(255,255,255,.15);border-radius:12px;color:#A0A0B8;font-weight:700;cursor:pointer;font-family:Poppins,sans-serif;">'+(cancel||'ƒ∞ptal')+'</button>'
        +'<button id="_rO" style="padding:12px 24px;background:'+(danger?'linear-gradient(135deg,#FF6584,#c0392b)':'linear-gradient(135deg,#00D9FF,#A855F7)')+';border:none;border-radius:12px;color:#0A0A0F;font-weight:800;cursor:pointer;font-family:Poppins,sans-serif;">'+(ok||'Onayla')+'</button>'
        +'</div></div>';
      document.body.appendChild(ov);
      ov.querySelector('#_rO').onclick=function(){ov.remove();resolve(true);};
      ov.querySelector('#_rC').onclick=function(){ov.remove();resolve(false);};
    });
  }
};

function handleLogout(){
  RoxyUI.confirm('√áƒ±kƒ±≈ü Yap','Hesabƒ±nƒ±zdan √ßƒ±kƒ±≈ü yapmak istiyor musunuz?','√áƒ±kƒ±≈ü Yap','ƒ∞ptal',true)
    .then(function(ok){if(ok)auth.signOut().then(function(){window.location.href='auth.html';});});
}

// AUTH + VERƒ∞ ‚Äî tek seferlik
var _unsub=auth.onAuthStateChanged(function(user){
  _unsub(); // hemen durdur, token yenilemesinde tetiklenmesin
  if(!user){window.location.href='auth.html';return;}

  db.collection('users').doc(user.uid).get().then(function(snap){
    var d=snap.exists?snap.data():{};
    var name=d.name||user.displayName||'Kullanƒ±cƒ±';
    var bal=d.balance||0;
    document.getElementById('welcomeMsg').textContent='Ho≈ü Geldin, '+name.split(' ')[0]+'! üëã';
    document.getElementById('balDisplay').textContent=formatPrice(bal);
    document.getElementById('statBal').textContent=formatPrice(bal);
    document.getElementById('userAvatar').src='https://ui-avatars.com/api/?name='+encodeURIComponent(name)+'&background=00D9FF&color=fff';
    document.getElementById('userName').textContent=name;
  });

  db.collection('orders').where('userId','==',user.uid).get()
    .then(function(snap){
      // Client-side sort (composite index gerekmez)
      var docs=[]; snap.forEach(function(d){docs.push(d);}); 
      docs.sort(function(a,b){var ta=a.data().createdAt;var tb=b.data().createdAt;if(!ta||!tb)return 0;return tb.seconds-ta.seconds;});
      var total=docs.length,pend=0,done=0;
      docs.forEach(function(d){var s=d.data().status;if(s==='pending'||s==='processing')pend++;if(s==='completed')done++;});
      document.getElementById('statTotal').textContent=total;
      document.getElementById('statPend').textContent=pend;
      document.getElementById('statDone').textContent=done;

      if(!docs.length)return;
      var st={pending:['‚è≥','#FFB347','Beklemede'],processing:['‚öôÔ∏è','#00D9FF','ƒ∞≈üleniyor'],completed:['‚úÖ','#00FF88','Tamamlandƒ±'],cancelled:['‚ùå','#FF6584','ƒ∞ptal']};
      var html='';
      docs.slice(0,10).forEach(function(doc){
        var o=doc.data(),s=st[o.status]||st.pending;
        html+='<div class="order-row">'
          +'<div><div class="ord-id">'+(o.orderId||'‚Äî')+'</div><div class="ord-info">'+(o.platform||'')+(o.service?' ¬∑ '+o.service:'')+'</div></div>'
          +'<div style="text-align:right"><div class="ord-price">'+formatPrice(o.price||0)+'</div>'
          +'<div class="ord-status" style="color:'+s[1]+'">'+s[0]+' '+s[2]+'</div></div>'
          +'</div>';
      });
      document.getElementById('ordersBox').innerHTML=html;
    }).catch(function(e){console.error('Sipari≈üler:',e);});
});
</script>
</body>
</html>
