<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Deƒüerlendirmeler - Roxy Store</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700;800;900&display=swap');
*,*::before,*::after{margin:0;padding:0;box-sizing:border-box;}
:root{--p:#00D9FF;--s:#A855F7;--g:#00FF88;--dark:#0A0A0F;--d2:#12121A;--d3:#1A1A28;--border:rgba(0,217,255,.12);--muted:#A0A0B8;--err:#FF6584;--warn:#FFB347;}
body{font-family:'Poppins',sans-serif;background:var(--dark);color:#fff;overflow-x:hidden;}
.sidebar{position:fixed;left:-280px;top:0;width:270px;height:100vh;background:rgba(26,26,40,.98);backdrop-filter:blur(24px);border-right:1px solid var(--border);z-index:1000;transition:left .3s;display:flex;flex-direction:column;}
.sidebar.open{left:0;}
.sb-head{padding:22px 20px;border-bottom:1px solid rgba(255,255,255,.05);display:flex;align-items:center;justify-content:space-between;flex-shrink:0;}
.logo{display:flex;align-items:center;gap:12px;}
.logo-icon{width:42px;height:42px;background:linear-gradient(135deg,var(--p),var(--s));border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:18px;color:#0A0A0F;}
.logo-main{font-size:22px;font-weight:900;background:linear-gradient(135deg,var(--p),var(--s));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;}
.logo-sub{font-size:10px;font-weight:600;color:var(--muted);letter-spacing:2px;display:block;}
.sb-close{background:transparent;border:none;color:var(--muted);font-size:22px;cursor:pointer;padding:6px;}
.sb-nav{flex:1;overflow-y:auto;padding:12px 0;}
.nav-item{display:flex;align-items:center;gap:12px;padding:13px 20px;color:var(--muted);text-decoration:none;border-left:3px solid transparent;font-size:14px;font-weight:500;transition:.2s;cursor:pointer;}
.nav-item:hover,.nav-item.active{background:rgba(0,217,255,.07);color:var(--p);border-left-color:var(--p);}
.nav-item i{width:20px;font-size:17px;text-align:center;}
.nav-sep{height:1px;background:rgba(255,255,255,.06);margin:8px 16px;}
.nav-item.support{color:var(--p);font-weight:700;}
.overlay{position:fixed;inset:0;background:rgba(0,0,0,.6);z-index:999;opacity:0;visibility:hidden;transition:.3s;}
.overlay.active{opacity:1;visibility:visible;}
.main{min-height:100vh;display:flex;flex-direction:column;}
.topbar{background:rgba(26,26,40,.98);backdrop-filter:blur(24px);border-bottom:1px solid var(--border);padding:0 24px;height:68px;display:flex;align-items:center;justify-content:space-between;position:sticky;top:0;z-index:100;}
.tb-left{display:flex;align-items:center;gap:14px;}
.menu-btn{background:transparent;border:none;color:#fff;font-size:22px;cursor:pointer;padding:8px;}
.tb-logo-text{font-size:18px;font-weight:900;background:linear-gradient(135deg,var(--p),var(--s));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;}
.tb-logo-sub{font-size:10px;color:var(--muted);letter-spacing:1.5px;font-weight:600;}
.tb-right{display:flex;align-items:center;gap:14px;}
.bal-box{display:flex;align-items:center;gap:10px;padding:9px 14px;background:rgba(0,217,255,.07);border:1.5px solid rgba(0,217,255,.2);border-radius:12px;cursor:pointer;transition:.2s;}
.bal-box:hover{border-color:var(--p);}
.bal-box i{color:var(--p);font-size:18px;}
.bal-label{font-size:10px;color:var(--muted);display:block;text-transform:uppercase;letter-spacing:.5px;}
.bal-amount{font-size:15px;font-weight:800;color:var(--p);}
.user-box{display:flex;align-items:center;gap:8px;cursor:pointer;}
.user-box img{width:38px;height:38px;border-radius:50%;border:2px solid var(--p);}
.user-box span{font-weight:600;font-size:14px;}
.content{flex:1;max-width:720px;width:100%;margin:0 auto;padding:36px 24px 60px;}
.page-hd{margin-bottom:28px;}
.page-hd h1{font-size:26px;font-weight:900;display:flex;align-items:center;gap:10px;margin-bottom:6px;}
.page-hd h1 i{color:var(--p);}
.page-hd p{color:var(--muted);}
.card{background:var(--d3);border:1.5px solid var(--border);border-radius:20px;padding:28px;margin-bottom:20px;}
.card-title{font-size:17px;font-weight:800;display:flex;align-items:center;gap:10px;margin-bottom:22px;}
.card-title i{color:var(--p);}
.field{margin-bottom:18px;}
.field-label{font-size:12px;font-weight:700;color:var(--muted);text-transform:uppercase;letter-spacing:.5px;margin-bottom:10px;display:block;}
/* STAR RATING */
.stars{display:flex;gap:8px;margin-bottom:6px;}
.star{font-size:32px;color:rgba(255,255,255,.15);cursor:pointer;transition:.15s;line-height:1;}
.star:hover,.star.active{color:#FFB800;}
.star-hint{font-size:13px;color:var(--muted);margin-top:4px;}
/* TEXTAREA */
.txtarea{width:100%;padding:14px 16px;background:var(--d2);border:1.5px solid rgba(255,255,255,.08);border-radius:12px;color:#fff;font-family:'Poppins',sans-serif;font-size:14px;outline:none;resize:vertical;transition:border .2s;}
.txtarea:focus{border-color:var(--p);}
.char-cnt{font-size:11px;color:var(--muted);text-align:right;margin-top:4px;}
.pending-note{display:flex;align-items:flex-start;gap:10px;background:rgba(255,179,71,.07);border:1px solid rgba(255,179,71,.2);border-radius:10px;padding:12px 14px;font-size:13px;color:var(--muted);margin-bottom:18px;}
.pending-note i{color:var(--warn);flex-shrink:0;margin-top:1px;}
.btn-submit{width:100%;display:flex;align-items:center;justify-content:center;gap:10px;padding:16px;background:linear-gradient(135deg,var(--p),var(--s));border:none;border-radius:13px;color:#0A0A0F;font-family:'Poppins',sans-serif;font-weight:800;font-size:16px;cursor:pointer;transition:.2s;}
.btn-submit:hover:not(:disabled){transform:translateY(-1px);}
.btn-submit:disabled{opacity:.35;cursor:not-allowed;}
/* REVIEWS */
.sec-title{font-size:18px;font-weight:800;margin-bottom:16px;display:flex;align-items:center;gap:10px;}
.sec-title i{color:var(--p);}
.review-card{background:var(--d3);border:1.5px solid var(--border);border-radius:16px;padding:20px;margin-bottom:12px;}
.rev-head{display:flex;align-items:center;justify-content:space-between;margin-bottom:10px;}
.rev-name{font-weight:700;font-size:14px;}
.rev-stars{color:#FFB800;font-size:13px;}
.rev-date{font-size:11px;color:var(--muted);}
.rev-text{font-size:14px;color:var(--muted);line-height:1.7;}
.rev-reply{margin-top:12px;padding:12px 14px;background:rgba(0,217,255,.06);border:1px solid rgba(0,217,255,.1);border-radius:10px;}
.rev-reply-label{font-size:11px;color:var(--p);font-weight:700;margin-bottom:4px;}
.rev-reply-text{font-size:13px;color:var(--muted);}
.empty{text-align:center;padding:40px;color:var(--muted);}
.empty i{font-size:36px;opacity:.25;display:block;margin-bottom:12px;}
footer{background:var(--d3);border-top:1px solid var(--border);padding:22px 24px;margin-top:auto;}
.foot-in{max-width:720px;margin:0 auto;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:12px;}
.foot-links{display:flex;gap:10px;}
.foot-link{display:flex;align-items:center;gap:6px;padding:8px 14px;border-radius:8px;text-decoration:none;font-size:13px;font-weight:600;color:#fff;}
.foot-link.wa{background:#25D366;}.foot-link.tg{background:#0088CC;}
.foot-copy{color:var(--muted);font-size:13px;}
@media(max-width:768px){.user-box span,.bal-label{display:none;}.content{padding:20px 14px;}}
</style>
</head>
<body>
<div class="sidebar" id="sidebar">
  <div class="sb-head">
    <div class="logo"><div class="logo-icon"><i class="fas fa-bolt"></i></div><div><span class="logo-main">ROXY</span><span class="logo-sub">STORE</span></div></div>
    <button class="sb-close" onclick="toggleSidebar()"><i class="fas fa-times"></i></button>
  </div>
  <nav class="sb-nav">
    <a href="dashboard.html" class="nav-item"><i class="fas fa-home"></i><span>Ana Sayfa</span></a>
    <a href="virtual-number.html" class="nav-item"><i class="fas fa-mobile-alt"></i><span>Sanal Numara</span></a>
    <a href="social-media.html" class="nav-item"><i class="fas fa-chart-line"></i><span>Sosyal Medya</span></a>
    <a href="balance.html" class="nav-item"><i class="fas fa-wallet"></i><span>Bakiye Ekle</span></a>
    <a href="reviews.html" class="nav-item active"><i class="fas fa-star"></i><span>Deƒüerlendirmeler</span></a>
    <div class="nav-sep"></div>
    <a href="support.html" class="nav-item support"><i class="fas fa-headset"></i><span>Destek</span></a>
    <a href="profile.html" class="nav-item"><i class="fas fa-user-circle"></i><span>Profil</span></a>
    <div class="nav-item" onclick="auth.signOut().then(function(){window.location.href='auth.html';})"><i class="fas fa-sign-out-alt"></i><span>√áƒ±kƒ±≈ü Yap</span></div>
  </nav>
</div>
<div class="overlay" id="overlay" onclick="toggleSidebar()"></div>

<div class="main">
  <div class="topbar">
    <div class="tb-left">
      <button class="menu-btn" onclick="toggleSidebar()"><i class="fas fa-bars"></i></button>
      <div><span class="tb-logo-text">ROXY</span> <span class="tb-logo-sub">STORE</span></div>
    </div>
    <div class="tb-right">
      <div class="bal-box" onclick="window.location.href='balance.html'">
        <i class="fas fa-wallet"></i>
        <div><span class="bal-label">Bakiye</span><span class="bal-amount" id="balDisplay">0 ‚Ç∫</span></div>
      </div>
      <div class="user-box" onclick="window.location.href='profile.html'">
        <img id="userAvatar" src="https://ui-avatars.com/api/?name=U&background=00D9FF&color=fff" alt="">
        <span id="userName">Kullanƒ±cƒ±</span>
      </div>
    </div>
  </div>

  <div class="content">
    <div class="page-hd">
      <h1><i class="fas fa-star"></i> Deƒüerlendirmeler</h1>
      <p>Hizmetlerimizi deƒüerlendirin, diƒüer kullanƒ±cƒ±larƒ±n yorumlarƒ±nƒ± g√∂r√ºn</p>
    </div>

    <!-- FORM -->
    <div class="card">
      <div class="card-title"><i class="fas fa-pen"></i> Deƒüerlendirme G√∂nder</div>
      <div class="field">
        <span class="field-label">Puanƒ±nƒ±z</span>
        <div class="stars" id="starRow">
          <span class="star" data-v="1" onclick="setRating(1)"><i class="fas fa-star"></i></span>
          <span class="star" data-v="2" onclick="setRating(2)"><i class="fas fa-star"></i></span>
          <span class="star" data-v="3" onclick="setRating(3)"><i class="fas fa-star"></i></span>
          <span class="star" data-v="4" onclick="setRating(4)"><i class="fas fa-star"></i></span>
          <span class="star" data-v="5" onclick="setRating(5)"><i class="fas fa-star"></i></span>
        </div>
        <div class="star-hint" id="starHint">Yƒ±ldƒ±z se√ßin</div>
      </div>
      <div class="field">
        <span class="field-label">Yorumunuz</span>
        <textarea class="txtarea" id="revText" placeholder="Deneyiminizi payla≈üƒ±n..." rows="4" maxlength="500" oninput="checkRevForm();document.getElementById('revCnt').textContent=this.value.length+'/500'"></textarea>
        <div class="char-cnt" id="revCnt">0/500</div>
      </div>
      <div class="pending-note">
        <i class="fas fa-clock"></i>
        <span>Yorumunuz ekibimiz tarafƒ±ndan incelendikten sonra yayƒ±nlanacaktƒ±r.</span>
      </div>
      <button class="btn-submit" id="btnRevSubmit" onclick="submitReview()" disabled>
        <i class="fas fa-paper-plane"></i> G√∂nder
      </button>
    </div>

    <!-- SON YORUMLAR -->
    <div class="sec-title"><i class="fas fa-comments"></i> Son Deƒüerlendirmeler</div>
    <div id="reviewsList">
      <div class="empty"><i class="fas fa-comments"></i><p>Hen√ºz onaylƒ± yorum yok</p></div>
    </div>
  </div>

  <footer>
    <div class="foot-in">
      <div class="foot-links">
        <a href="https://wa.me/447795203704" target="_blank" class="foot-link wa"><i class="fab fa-whatsapp"></i> WhatsApp</a>
        <a href="https://t.me/roxysatici" target="_blank" class="foot-link tg"><i class="fab fa-telegram"></i> Telegram</a>
      </div>
      <span class="foot-copy">¬© 2026 Roxy Store</span>
    </div>
  </footer>
</div>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<script>
var _app=firebase.apps.length?firebase.apps[0]:firebase.initializeApp({apiKey:"AIzaSyBf2A1GhEzruI_6lfCNbq4MsbU8hxFjoqI",authDomain:"roxy-store-67c53.firebaseapp.com",projectId:"roxy-store-67c53",storageBucket:"roxy-store-67c53.firebasestorage.app",messagingSenderId:"450502544206",appId:"1:450502544206:web:502d0200dc35ecacfc2c1f"});
var auth=firebase.auth(),db=firebase.firestore();
var _user=null,_udata=null,_rating=0;
var HINTS=['','üòû √áok K√∂t√º','üòê K√∂t√º','üôÇ Orta','üòä ƒ∞yi','ü§© M√ºkemmel!'];

function formatPrice(n){return Math.round(n||0).toLocaleString('tr-TR')+' ‚Ç∫';}
function toggleSidebar(){document.getElementById('sidebar').classList.toggle('open');document.getElementById('overlay').classList.toggle('active');}

var RoxyUI={toast:function(msg,type,dur){dur=dur||3500;var c={success:'#00FF88',error:'#FF6584',warning:'#FFB347',info:'#00D9FF'};var ic={success:'check-circle',error:'times-circle',warning:'exclamation-triangle',info:'info-circle'};var w=document.getElementById('_rt');if(!w){w=document.createElement('div');w.id='_rt';w.style.cssText='position:fixed;bottom:24px;right:24px;z-index:99999;display:flex;flex-direction:column;gap:10px;max-width:360px;';document.body.appendChild(w);}var t=document.createElement('div');t.style.cssText='display:flex;align-items:center;gap:12px;padding:14px 18px;background:#1F1F2E;border:1.5px solid '+(c[type]||c.info)+';border-radius:14px;font-family:Poppins,sans-serif;font-size:14px;color:#fff;box-shadow:0 8px 32px rgba(0,0,0,.5);';t.innerHTML='<i class="fas fa-'+(ic[type]||'info-circle')+'" style="color:'+(c[type]||c.info)+';font-size:18px;flex-shrink:0"></i><span>'+msg+'</span>';w.appendChild(t);setTimeout(function(){t.style.transition='.3s';t.style.opacity='0';t.style.transform='translateY(8px)';setTimeout(function(){t.remove();},300);},dur);}};

var _unsub=auth.onAuthStateChanged(function(user){
  _unsub();
  if(!user){window.location.href='auth.html';return;}
  _user=user;
  db.collection('users').doc(user.uid).get().then(function(s){
    _udata=s.exists?s.data():{balance:0};
    var n=_udata.name||user.displayName||'Kullanƒ±cƒ±';
    document.getElementById('balDisplay').textContent=formatPrice(_udata.balance||0);
    document.getElementById('userAvatar').src='https://ui-avatars.com/api/?name='+encodeURIComponent(n)+'&background=00D9FF&color=fff';
    document.getElementById('userName').textContent=n;
    loadReviews();
  });
});

function setRating(v){
  _rating=v;
  document.querySelectorAll('.star').forEach(function(s){s.classList.toggle('active',parseInt(s.dataset.v)<=v);});
  document.getElementById('starHint').textContent=HINTS[v]||'';
  checkRevForm();
}
function checkRevForm(){
  var txt=(document.getElementById('revText').value||'').trim();
  document.getElementById('btnRevSubmit').disabled=!(_rating>0&&txt.length>=10);
}
function submitReview(){
  var txt=(document.getElementById('revText').value||'').trim();
  if(!_rating||txt.length<10)return;
  var btn=document.getElementById('btnRevSubmit');
  btn.disabled=true;btn.innerHTML='<i class="fas fa-spinner fa-spin"></i> G√∂nderiliyor...';
  db.collection('reviews').add({
    userId:_user.uid,userEmail:_user.email,
    userName:(_udata&&_udata.name)?_udata.name:'Anonim',
    rating:_rating,text:txt,status:'pending',reply:null,
    createdAt:firebase.firestore.FieldValue.serverTimestamp()
  }).then(function(){
    document.getElementById('revText').value='';
    document.getElementById('revCnt').textContent='0/500';
    _rating=0;
    document.querySelectorAll('.star').forEach(function(s){s.classList.remove('active');});
    document.getElementById('starHint').textContent='Yƒ±ldƒ±z se√ßin';
    btn.innerHTML='<i class="fas fa-paper-plane"></i> G√∂nder';btn.disabled=true;
    RoxyUI.toast('‚úÖ Yorumunuz incelemeye alƒ±ndƒ±!','success',4000);
  }).catch(function(e){btn.disabled=false;btn.innerHTML='<i class="fas fa-paper-plane"></i> G√∂nder';RoxyUI.toast('Hata: '+e.message,'error');});
}
function loadReviews(){
  db.collection('reviews').where('status','in',['approved','replied']).get()
    .then(function(snap){
      var el=document.getElementById('reviewsList');
      var docs=[]; snap.forEach(function(d){docs.push(d);}); 
      docs.sort(function(a,b){var ta=a.data().createdAt;var tb=b.data().createdAt;if(!ta||!tb)return 0;return tb.seconds-ta.seconds;});
      if(!docs.length){el.innerHTML='<div class="empty"><i class="fas fa-comments"></i><p>Hen√ºz onaylƒ± yorum yok</p></div>';return;}
      var html='';
      docs.slice(0,10).forEach(function(d){
        var r=d.data();
        var stars='';for(var i=1;i<=5;i++)stars+='<i class="fas fa-star" style="color:'+(i<=r.rating?'#FFB800':'rgba(255,255,255,.15)')+'"></i>';
        var dt=r.createdAt?r.createdAt.toDate().toLocaleDateString('tr-TR'):'‚Äî';
        html+='<div class="review-card">'
          +'<div class="rev-head"><div><div class="rev-name">'+r.userName+'</div><div class="rev-date">'+dt+'</div></div><div class="rev-stars">'+stars+'</div></div>'
          +'<div class="rev-text">'+r.text+'</div>'
          +(r.reply?'<div class="rev-reply"><div class="rev-reply-label"><i class="fas fa-reply"></i> Roxy Store Yanƒ±tƒ±</div><div class="rev-reply-text">'+r.reply+'</div></div>':'')
          +'</div>';
      });
      el.innerHTML=html;
    }).catch(function(e){console.log(e);});
}
</script>
</body>
</html>
